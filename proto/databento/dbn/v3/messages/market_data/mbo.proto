syntax = "proto3";

package databento.dbn.v3.messages.market_data;

import "databento/dbn/v3/common/header.proto";
import "databento/dbn/v3/enums/action.proto";
import "databento/dbn/v3/enums/side.proto";

option go_package = "github.com/databento/dbn/gen/go/databento/dbn/v3/messages/market_data";
option java_multiple_files = true;
option java_package = "com.databento.dbn.v3.messages.market_data";

// MboMsg represents a market-by-order (MBO) tick message.
// Binary layout: 80 bytes, 8-byte aligned
// RType: 0xA0 (160)
message MboMsg {
  // Common record header (16 bytes)
  databento.dbn.v3.common.RecordHeader hd = 1;

  // Order ID assigned at the venue (u64, fixed-width)
  fixed64 order_id = 2;

  // Order price (i64, fixed-width, signed)
  // Fixed-point: divide by 1,000,000,000 to get decimal price
  sfixed64 price = 3;

  // Order quantity (u32, fixed-width)
  fixed32 size = 4;

  // Event flags bit field (u8 in binary, packed as u32)
  // See flags module for bit definitions
  uint32 flags = 5;

  // Channel ID (u8 in binary, packed as u32)
  // Zero-indexed channel identifier
  uint32 channel_id = 6;

  // Order event action (c_char in binary)
  databento.dbn.v3.enums.Action action = 7;

  // Market side (c_char in binary)
  databento.dbn.v3.enums.Side side = 8;

  // Capture-server-received timestamp (u64, fixed-width)
  // UNIX epoch nanoseconds
  fixed64 ts_recv = 9;

  // Matching-engine-sending timestamp delta (i32, signed fixed-width)
  // Nanoseconds before ts_recv
  sfixed32 ts_in_delta = 10;

  // Message sequence number (u32, fixed-width)
  fixed32 sequence = 11;
}
