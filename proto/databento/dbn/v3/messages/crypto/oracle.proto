syntax = "proto3";

package databento.dbn.v3.messages.crypto;

import "databento/dbn/v3/common/header.proto";

option go_package = "github.com/databento/dbn/gen/go/databento/dbn/v3/messages/crypto";
option java_multiple_files = true;
option java_package = "com.databento.dbn.v3.messages.crypto";

// OraclePriceMsg represents a price update from an on-chain oracle.
// Binary layout: 80 bytes, 8-byte aligned
// RType: 0xD6 (214)
message OraclePriceMsg {
  databento.dbn.v3.common.RecordHeader hd = 1;
  fixed64 ts_recv = 2;

  // On-chain metadata
  fixed64 block_number = 3;
  fixed64 block_timestamp = 4;

  // Oracle data (fixed-point, scale 1e-9)
  sfixed64 price = 5;
  sfixed64 confidence_interval = 6;

  // Number of contributing sources and oracle type
  uint32 num_sources = 7;
  uint32 oracle_type = 8; // 1=Chainlink, 2=Pyth, 3=Band, etc.

  // Oracle metadata
  bytes oracle_address = 9; // 20-byte contract address
  fixed64 round_id = 10;

  // Message sequence number (u32, fixed-width)
  fixed32 sequence = 11;
}
