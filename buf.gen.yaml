version: v2
managed:
  enabled: true
  override:
    - file_option: go_package_prefix
      value: github.com/databento/dbn/gen/go
plugins:
  # Generate JSON Schema (official Buf plugin)
  - remote: buf.build/bufbuild/protoschema-jsonschema:v0.5.2
    out: jsonschema
    opt:
      - target=proto+json

  # Generate Go code with proper protobuf support
  - remote: buf.build/protocolbuffers/go
    out: gen/go
    opt:
      - paths=source_relative

  # Generate Python code with type stubs
  - remote: buf.build/protocolbuffers/python
    out: gen/python
    opt:
      - pyi_out=gen/python

  # Generate TypeScript code
  - remote: buf.build/community/timostamm-protobuf-ts
    out: gen/ts
    opt:
      - long_type_string
      - optimize_code_size
